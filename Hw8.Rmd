---
title: ""
output: html_document
---
<p align="center"><font size="8">2017BIHomework8</font></p>
<p align="center"><font size="4">Cai Jing</font></p>

```{r}
# 载入数据 
life <- data.frame(
  X1=c(2.5,173,119,10,502,4,14.4,2,40,6.6,21.4,2.8,2.5,6,3.5,62.2,10.8,21.6,2,3.4,5.1,2.4,1.7,1.1,12.8,1.2,3.5,39.7,62.4,2.4,34.7,28.4,0.9,30.6,5.8,6.1,2.7,4.7,128,35,2,8.5,2,2,4.3,244.8,4,5.1,32,1.4),
  X2=rep(c(0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0),c(1,4,2,2,1,1,8,1,5,1,5,1,1,1,2,1,1,1,3,1,2,1,4)),
  X3=rep(c(0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1),c(6,1,3,1,3,1,1,5,1,3,7,1,1,3,1,1,2,9)),
  Y=rep(c(0,1,0,1),c(15,10,15,10)))
#Logistic分析 
glm.sol <- glm(Y~X1+X2+X3,family=binomial,data=life)
summary(glm.sol)

# 前两项的指标观测值为 X1=5,X2=2, 若无巩固治疗 (X3=0),预测其 1 年以上存活的概率
pre = predict(glm.sol, data.frame(X1=5,X2=2,X3=0))
p <- exp(pre)/(1+exp(pre))
cat("X1=5,X2=2, 若无巩固治疗 (X3=0),预测其 1 年以上存活的概率 = ", p, "\n")

# 分析有无巩固治疗对病人生存概率的影响
# 先对Y和X1、X2、X3做总体的多元Logistic分析
lm <- lm(Y~X1+X2+X3,data=life)# 求的表达式Y= 0.0002775X1-0.1147739X2+0.5394936X3+0.1895442，可以看出X3系数最大 
summary(lm)
# 分别对Y和X1做线性回归分析
lm.sol1 <- lm(Y~X1,data=life)
summary(lm.sol1)
# r^2= 0.01712,较小 p=0.365较大，不显著

# 再对Y和X2做线性回归分析
lm.sol2 <- lm(Y~X2,data=life)
summary(lm.sol2)
# r^2= 0.07143较小, p=0.0606较大，不显著

# 最后对Y和X3做线性回归分析
lm.sol3 <- lm(Y~X3,data=life)
summary(lm.sol3)
# r^2= 0.3267较大, p=1.456e-05较小，极度显著
# 所以相比较有无巩固治疗对病人生存概率的影响最大
```

